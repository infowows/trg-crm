{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/WOWS_Test/trg-crm/models/CategoryGroup.ts"],"sourcesContent":["import mongoose, { Schema, Document } from \"mongoose\";\r\n\r\nexport interface ICategoryGroup extends Document {\r\n  name: string;\r\n  code: string;\r\n  note?: string;\r\n  isActive: boolean;\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n}\r\n\r\nconst CategoryGroupSchema: Schema = new Schema(\r\n  {\r\n    name: {\r\n      type: String,\r\n      required: true,\r\n      trim: true,\r\n    },\r\n    code: {\r\n      type: String,\r\n      required: true,\r\n      unique: true,\r\n      uppercase: true,\r\n      trim: true,\r\n    },\r\n    note: {\r\n      type: String,\r\n      trim: true,\r\n    },\r\n    isActive: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n  },\r\n  {\r\n    timestamps: true,\r\n    collection: \"Nh√≥m h·∫°ng m·ª•c\",\r\n  },\r\n);\r\n\r\nexport default mongoose.models.CategoryGroup ||\r\n  mongoose.model<ICategoryGroup>(\"CategoryGroup\", CategoryGroupSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAWA,MAAM,sBAA8B,IAAI,kKAAM,CAC5C;IACE,MAAM;QACJ,MAAM;QACN,UAAU;QACV,MAAM;IACR;IACA,MAAM;QACJ,MAAM;QACN,UAAU;QACV,QAAQ;QACR,WAAW;QACX,MAAM;IACR;IACA,MAAM;QACJ,MAAM;QACN,MAAM;IACR;IACA,UAAU;QACR,MAAM;QACN,SAAS;IACX;AACF,GACA;IACE,YAAY;IACZ,YAAY;AACd;uCAGa,mKAAQ,CAAC,MAAM,CAAC,aAAa,IAC1C,mKAAQ,CAAC,KAAK,CAAiB,iBAAiB"}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///D:/WOWS_Test/trg-crm/lib/dbConnect.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\ninterface Connection {\r\n    isConnected: boolean;\r\n}\r\n\r\nconst connection: Connection = { isConnected: false };\r\n\r\nasync function dbConnect(): Promise<typeof mongoose> {\r\n    if (connection.isConnected) {\r\n        console.log(\"‚ôªÔ∏è Using existing MongoDB connection\");\r\n        return mongoose;\r\n    }\r\n\r\n    try {\r\n        console.log(\"üì° Connecting to MongoDB...\");\r\n\r\n        const db = await mongoose.connect(process.env.MONGODB_URI!, {\r\n            bufferCommands: false,\r\n        });\r\n\r\n        connection.isConnected = db.connections[0].readyState === 1;\r\n\r\n        console.log(\"‚úÖ MongoDB connected successfully\");\r\n        console.log(\"üìä Database name:\", db.connection.name);\r\n\r\n        return db;\r\n    } catch (error) {\r\n        console.error(\"‚ùå MongoDB connection error:\", error);\r\n        connection.isConnected = false;\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport default dbConnect;\r\n"],"names":[],"mappings":";;;;AAAA;;AAMA,MAAM,aAAyB;IAAE,aAAa;AAAM;AAEpD,eAAe;IACX,IAAI,WAAW,WAAW,EAAE;QACxB,QAAQ,GAAG,CAAC;QACZ,OAAO,mKAAQ;IACnB;IAEA,IAAI;QACA,QAAQ,GAAG,CAAC;QAEZ,MAAM,KAAK,MAAM,mKAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAG;YACxD,gBAAgB;QACpB;QAEA,WAAW,WAAW,GAAG,GAAG,WAAW,CAAC,EAAE,CAAC,UAAU,KAAK;QAE1D,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,qBAAqB,GAAG,UAAU,CAAC,IAAI;QAEnD,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,WAAW,WAAW,GAAG;QACzB,MAAM;IACV;AACJ;uCAEe"}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///D:/WOWS_Test/trg-crm/app/api/category-groups/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport CategoryGroup from \"@/models/CategoryGroup\";\nimport connectDB from \"../../../lib/dbConnect\";\n\nexport async function GET(request: NextRequest) {\n  try {\n    await connectDB();\n\n    const { searchParams } = new URL(request.url);\n    const page = parseInt(searchParams.get(\"page\") || \"1\");\n    const limit = parseInt(searchParams.get(\"limit\") || \"10\");\n    const search = searchParams.get(\"search\") || \"\";\n    const isActive = searchParams.get(\"isActive\");\n\n    const query: any = {};\n\n    if (search) {\n      query.$or = [\n        { name: { $regex: search, $options: \"i\" } },\n        { code: { $regex: search, $options: \"i\" } },\n        { note: { $regex: search, $options: \"i\" } },\n      ];\n    }\n\n    if (isActive !== null && isActive !== undefined) {\n      query.isActive = isActive === \"true\";\n    }\n\n    const skip = (page - 1) * limit;\n\n    const [categoryGroups, total] = await Promise.all([\n      CategoryGroup.find(query).sort({ createdAt: -1 }).skip(skip).limit(limit),\n      CategoryGroup.countDocuments(query),\n    ]);\n\n    return NextResponse.json({\n      success: true,\n      data: categoryGroups,\n      pagination: {\n        page,\n        limit,\n        total,\n        pages: Math.ceil(total / limit),\n      },\n    });\n  } catch (error) {\n    console.error(\"Error fetching category groups:\", error);\n    return NextResponse.json(\n      { success: false, error: \"Kh√¥ng th·ªÉ l·∫•y danh s√°ch nh√≥m h·∫°ng m·ª•c\" },\n      { status: 500 },\n    );\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    await connectDB();\n\n    const body = await request.json();\n    const { name, note } = body;\n\n    if (!name) {\n      return NextResponse.json(\n        { success: false, error: \"T√™n nh√≥m l√† b·∫Øt bu·ªôc\" },\n        { status: 400 },\n      );\n    }\n\n    // T·ª± ƒë·ªông t·∫°o m√£ nh√≥m: NHM-0001\n    const count = await CategoryGroup.countDocuments();\n    const code = `NHM-${String(count + 1).padStart(4, \"0\")}`;\n\n    const categoryGroup = new CategoryGroup({\n      name: name.trim(),\n      code,\n      note: note?.trim() || \"\",\n    });\n\n    await categoryGroup.save();\n\n    return NextResponse.json({\n      success: true,\n      data: categoryGroup,\n      message: \"T·∫°o nh√≥m h·∫°ng m·ª•c th√†nh c√¥ng\",\n    });\n  } catch (error) {\n    console.error(\"Error creating category group:\", error);\n    return NextResponse.json(\n      { success: false, error: \"Kh√¥ng th·ªÉ t·∫°o nh√≥m h·∫°ng m·ª•c\" },\n      { status: 500 },\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,IAAA,6HAAS;QAEf,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,OAAO,SAAS,aAAa,GAAG,CAAC,WAAW;QAClD,MAAM,QAAQ,SAAS,aAAa,GAAG,CAAC,YAAY;QACpD,MAAM,SAAS,aAAa,GAAG,CAAC,aAAa;QAC7C,MAAM,WAAW,aAAa,GAAG,CAAC;QAElC,MAAM,QAAa,CAAC;QAEpB,IAAI,QAAQ;YACV,MAAM,GAAG,GAAG;gBACV;oBAAE,MAAM;wBAAE,QAAQ;wBAAQ,UAAU;oBAAI;gBAAE;gBAC1C;oBAAE,MAAM;wBAAE,QAAQ;wBAAQ,UAAU;oBAAI;gBAAE;gBAC1C;oBAAE,MAAM;wBAAE,QAAQ;wBAAQ,UAAU;oBAAI;gBAAE;aAC3C;QACH;QAEA,IAAI,aAAa,QAAQ,aAAa,WAAW;YAC/C,MAAM,QAAQ,GAAG,aAAa;QAChC;QAEA,MAAM,OAAO,CAAC,OAAO,CAAC,IAAI;QAE1B,MAAM,CAAC,gBAAgB,MAAM,GAAG,MAAM,QAAQ,GAAG,CAAC;YAChD,oIAAa,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC;gBAAE,WAAW,CAAC;YAAE,GAAG,IAAI,CAAC,MAAM,KAAK,CAAC;YACnE,oIAAa,CAAC,cAAc,CAAC;SAC9B;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;YACN,YAAY;gBACV;gBACA;gBACA;gBACA,OAAO,KAAK,IAAI,CAAC,QAAQ;YAC3B;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAAwC,GACjE;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,IAAA,6HAAS;QAEf,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG;QAEvB,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAuB,GAChD;gBAAE,QAAQ;YAAI;QAElB;QAEA,gCAAgC;QAChC,MAAM,QAAQ,MAAM,oIAAa,CAAC,cAAc;QAChD,MAAM,OAAO,CAAC,IAAI,EAAE,OAAO,QAAQ,GAAG,QAAQ,CAAC,GAAG,MAAM;QAExD,MAAM,gBAAgB,IAAI,oIAAa,CAAC;YACtC,MAAM,KAAK,IAAI;YACf;YACA,MAAM,MAAM,UAAU;QACxB;QAEA,MAAM,cAAc,IAAI;QAExB,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;YACN,SAAS;QACX;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAA8B,GACvD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}