{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///D:/WOWS_Test/trg-crm/app/login/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, Suspense } from \"react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport Image from \"next/image\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\nimport {\r\n    Eye,\r\n    EyeOff,\r\n    User,\r\n    Lock,\r\n    BarChart3,\r\n    CheckCircle,\r\n    Settings,\r\n    FileText,\r\n    ShoppingCart,\r\n    TrendingUp,\r\n    Package,\r\n} from \"lucide-react\";\r\n\r\nfunction LoginContent() {\r\n    const router = useRouter();\r\n    const searchParams = useSearchParams();\r\n    const [loading, setLoading] = useState(false);\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [formData, setFormData] = useState({\r\n        username: \"\",\r\n        password: \"\",\r\n    });\r\n    const [rememberMe, setRememberMe] = useState(false);\r\n\r\n    useEffect(() => {\r\n        // Kiểm tra nếu đã đăng nhập\r\n        const token = localStorage.getItem(\"token\");\r\n        if (token) {\r\n            const returnUrl = searchParams.get(\"returnUrl\");\r\n            router.push(returnUrl || \"/dashboard\");\r\n            return;\r\n        }\r\n\r\n        // Tự động điền lại nếu đã lưu\r\n        const remembered = localStorage.getItem(\"rememberedUser\");\r\n        if (remembered) {\r\n            const { username, password } = JSON.parse(remembered);\r\n            setFormData({ username, password });\r\n            setRememberMe(true);\r\n        }\r\n    }, [router, searchParams]);\r\n\r\n    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const { name, value } = e.target;\r\n        setFormData((prev) => ({\r\n            ...prev,\r\n            [name]: value,\r\n        }));\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n\r\n        try {\r\n            const response = await fetch(\"/api/auth/login\", {\r\n                method: \"POST\",\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\",\r\n                },\r\n                body: JSON.stringify(formData),\r\n            });\r\n\r\n            const data = await response.json();\r\n\r\n            if (response.ok) {\r\n                // Lưu token và thông tin user\r\n                localStorage.setItem(\"token\", data.token);\r\n                localStorage.setItem(\"userData\", JSON.stringify(data.user));\r\n\r\n                // Lưu thông tin đăng nhập nếu chọn \"Ghi nhớ\"\r\n                if (rememberMe) {\r\n                    localStorage.setItem(\r\n                        \"rememberedUser\",\r\n                        JSON.stringify({\r\n                            username: formData.username,\r\n                            password: formData.password,\r\n                        }),\r\n                    );\r\n                } else {\r\n                    localStorage.removeItem(\"rememberedUser\");\r\n                }\r\n\r\n                toast.success(\"Đăng nhập thành công!\");\r\n\r\n                const returnUrl = searchParams.get(\"returnUrl\");\r\n                router.push(returnUrl || \"/dashboard\");\r\n            } else {\r\n                toast.error(data.message || \"Đăng nhập thất bại\");\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Login error:\", error);\r\n            toast.error(\"Có lỗi xảy ra. Vui lòng thử lại.\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const features = [\r\n        {\r\n            icon: BarChart3,\r\n            title: \"Dashboard\",\r\n            description: \"Xem tổng quan hệ thống\",\r\n        },\r\n        {\r\n            icon: User,\r\n            title: \"Quản lý người dùng\",\r\n            description: \"Phân quyền và quản lý tài khoản\",\r\n        },\r\n        {\r\n            icon: ShoppingCart,\r\n            title: \"Quản lý khách hàng\",\r\n            description: \"Theo dõi thông tin khách hàng\",\r\n        },\r\n        {\r\n            icon: FileText,\r\n            title: \"Quản lý báo giá\",\r\n            description: \"Tạo và quản lý khảo sát - báo giá\",\r\n        },\r\n        {\r\n            icon: Package,\r\n            title: \"Quản lý dịch vụ\",\r\n            description: \"Danh mục dịch vụ\",\r\n        },\r\n        {\r\n            icon: TrendingUp,\r\n            title: \"Báo cáo\",\r\n            description: \"Thống kê và báo cáo\",\r\n        },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4\">\r\n            <div className=\"max-w-6xl w-full flex flex-col lg:flex-row bg-white rounded-2xl shadow-xl overflow-hidden\">\r\n                {/* Left Panel - Features */}\r\n                <div className=\"lg:w-1/2 bg-gradient-to-br from-blue-600 to-indigo-700 p-8 lg:p-12 text-white\">\r\n                    <div className=\"mb-8\">\r\n                        <div className=\"flex items-center mb-4\">\r\n                            <div className=\"w-12 h-12 bg-white rounded-lg flex items-center justify-center mr-3 overflow-hidden\">\r\n                                <Image\r\n                                    src=\"/images/logo.png\"\r\n                                    alt=\"Trường Giang CRM\"\r\n                                    width={40}\r\n                                    height={40}\r\n                                    className=\"object-contain\"\r\n                                    priority\r\n                                    unoptimized\r\n                                />\r\n                            </div>\r\n                            <h1 className=\"text-2xl font-bold\">Trường Giang CRM</h1>\r\n                        </div>\r\n                        <h2 className=\"text-3xl font-bold mb-2\">\r\n                            Hệ thống Quản lý Khách hàng\r\n                        </h2>\r\n                        <p className=\"text-blue-100\">\r\n                            Giải pháp toàn diện cho doanh nghiệp của bạn\r\n                        </p>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-4\">\r\n                        <h3 className=\"text-xl font-semibold mb-4\">\r\n                            Tính năng nổi bật:\r\n                        </h3>\r\n                        {features.map((feature, index) => (\r\n                            <div\r\n                                key={index}\r\n                                className=\"flex items-start space-x-3\"\r\n                            >\r\n                                <feature.icon className=\"w-5 h-5 mt-1 flex-shrink-0\" />\r\n                                <div>\r\n                                    <h4 className=\"font-semibold\">\r\n                                        {feature.title}\r\n                                    </h4>\r\n                                    <p className=\"text-sm text-blue-100\">\r\n                                        {feature.description}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Right Panel - Login Form */}\r\n                <div className=\"lg:w-1/2 p-8 lg:p-12\">\r\n                    <div className=\"max-w-md mx-auto\">\r\n                        <div className=\"text-center mb-8\">\r\n                            <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">\r\n                                Đăng nhập\r\n                            </h2>\r\n                            <p className=\"text-gray-600\">\r\n                                Đăng nhập để tiếp tục sử dụng hệ thống\r\n                            </p>\r\n                        </div>\r\n\r\n                        <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n                            {/* Username Field */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                    Tên đăng nhập\r\n                                </label>\r\n                                <div className=\"relative\">\r\n                                    <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                        <User className=\"h-5 w-5 text-gray-400\" />\r\n                                    </div>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        name=\"username\"\r\n                                        value={formData.username}\r\n                                        onChange={handleInputChange}\r\n                                        required\r\n                                        className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition\"\r\n                                        placeholder=\"Nhập tên đăng nhập\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Password Field */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                                    Mật khẩu\r\n                                </label>\r\n                                <div className=\"relative\">\r\n                                    <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                                        <Lock className=\"h-5 w-5 text-gray-400\" />\r\n                                    </div>\r\n                                    <input\r\n                                        type={\r\n                                            showPassword ? \"text\" : \"password\"\r\n                                        }\r\n                                        name=\"password\"\r\n                                        value={formData.password}\r\n                                        onChange={handleInputChange}\r\n                                        required\r\n                                        className=\"block w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition\"\r\n                                        placeholder=\"Nhập mật khẩu\"\r\n                                    />\r\n                                    <button\r\n                                        type=\"button\"\r\n                                        onClick={() =>\r\n                                            setShowPassword(!showPassword)\r\n                                        }\r\n                                        className=\"absolute inset-y-0 right-0 pr-3 flex items-center\"\r\n                                    >\r\n                                        {showPassword ? (\r\n                                            <EyeOff className=\"h-5 w-5 text-gray-400 hover:text-gray-600\" />\r\n                                        ) : (\r\n                                            <Eye className=\"h-5 w-5 text-gray-400 hover:text-gray-600\" />\r\n                                        )}\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Remember Me */}\r\n                            <div className=\"flex items-center\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    id=\"remember\"\r\n                                    checked={rememberMe}\r\n                                    onChange={(e) =>\r\n                                        setRememberMe(e.target.checked)\r\n                                    }\r\n                                    className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                                />\r\n                                <label\r\n                                    htmlFor=\"remember\"\r\n                                    className=\"ml-2 block text-sm text-gray-700\"\r\n                                >\r\n                                    Ghi nhớ đăng nhập\r\n                                </label>\r\n                            </div>\r\n\r\n                            {/* Submit Button */}\r\n                            <button\r\n                                type=\"submit\"\r\n                                disabled={loading}\r\n                                className=\"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-200 disabled:opacity-50 disabled:cursor-not-allowed transition duration-200 font-medium\"\r\n                            >\r\n                                {loading ? (\r\n                                    <div className=\"flex items-center justify-center\">\r\n                                        <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2\"></div>\r\n                                        Đang đăng nhập...\r\n                                    </div>\r\n                                ) : (\r\n                                    \"Đăng nhập\"\r\n                                )}\r\n                            </button>\r\n                        </form>\r\n\r\n                        {/* Footer */}\r\n                        <div className=\"mt-8 text-center\">\r\n                            <p className=\"text-sm text-gray-500\">\r\n                                © 2024 Trường Giang CRM. All rights reserved.\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nconst LoginPage = () => {\r\n    return (\r\n        <Suspense fallback={<div>Loading...</div>}>\r\n            <LoginContent />\r\n        </Suspense>\r\n    );\r\n};\r\n\r\nexport default LoginPage;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AARA;;;;;;;;AAsBA,SAAS;IACL,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,eAAe,IAAA,qJAAe;IACpC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;QACrC,UAAU;QACV,UAAU;IACd;IACA,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,IAAA,kNAAS,EAAC;QACN,4BAA4B;QAC5B,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,OAAO;YACP,MAAM,YAAY,aAAa,GAAG,CAAC;YACnC,OAAO,IAAI,CAAC,aAAa;YACzB;QACJ;QAEA,8BAA8B;QAC9B,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,IAAI,YAAY;YACZ,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,KAAK,KAAK,CAAC;YAC1C,YAAY;gBAAE;gBAAU;YAAS;YACjC,cAAc;QAClB;IACJ,GAAG;QAAC;QAAQ;KAAa;IAEzB,MAAM,oBAAoB,CAAC;QACvB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAC,OAAS,CAAC;gBACnB,GAAG,IAAI;gBACP,CAAC,KAAK,EAAE;YACZ,CAAC;IACL;IAEA,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,WAAW;QAEX,IAAI;YACA,MAAM,WAAW,MAAM,MAAM,mBAAmB;gBAC5C,QAAQ;gBACR,SAAS;oBACL,gBAAgB;gBACpB;gBACA,MAAM,KAAK,SAAS,CAAC;YACzB;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,IAAI,SAAS,EAAE,EAAE;gBACb,8BAA8B;gBAC9B,aAAa,OAAO,CAAC,SAAS,KAAK,KAAK;gBACxC,aAAa,OAAO,CAAC,YAAY,KAAK,SAAS,CAAC,KAAK,IAAI;gBAEzD,6CAA6C;gBAC7C,IAAI,YAAY;oBACZ,aAAa,OAAO,CAChB,kBACA,KAAK,SAAS,CAAC;wBACX,UAAU,SAAS,QAAQ;wBAC3B,UAAU,SAAS,QAAQ;oBAC/B;gBAER,OAAO;oBACH,aAAa,UAAU,CAAC;gBAC5B;gBAEA,4JAAK,CAAC,OAAO,CAAC;gBAEd,MAAM,YAAY,aAAa,GAAG,CAAC;gBACnC,OAAO,IAAI,CAAC,aAAa;YAC7B,OAAO;gBACH,4JAAK,CAAC,KAAK,CAAC,KAAK,OAAO,IAAI;YAChC;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,gBAAgB;YAC9B,4JAAK,CAAC,KAAK,CAAC;QAChB,SAAU;YACN,WAAW;QACf;IACJ;IAEA,MAAM,WAAW;QACb;YACI,MAAM,+NAAS;YACf,OAAO;YACP,aAAa;QACjB;QACA;YACI,MAAM,0MAAI;YACV,OAAO;YACP,aAAa;QACjB;QACA;YACI,MAAM,sOAAY;YAClB,OAAO;YACP,aAAa;QACjB;QACA;YACI,MAAM,0NAAQ;YACd,OAAO;YACP,aAAa;QACjB;QACA;YACI,MAAM,mNAAO;YACb,OAAO;YACP,aAAa;QACjB;QACA;YACI,MAAM,gOAAU;YAChB,OAAO;YACP,aAAa;QACjB;KACH;IAED,qBACI,8OAAC;QAAI,WAAU;kBACX,cAAA,8OAAC;YAAI,WAAU;;8BAEX,8OAAC;oBAAI,WAAU;;sCACX,8OAAC;4BAAI,WAAU;;8CACX,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;4CAAI,WAAU;sDACX,cAAA,8OAAC,wIAAK;gDACF,KAAI;gDACJ,KAAI;gDACJ,OAAO;gDACP,QAAQ;gDACR,WAAU;gDACV,QAAQ;gDACR,WAAW;;;;;;;;;;;sDAGnB,8OAAC;4CAAG,WAAU;sDAAqB;;;;;;;;;;;;8CAEvC,8OAAC;oCAAG,WAAU;8CAA0B;;;;;;8CAGxC,8OAAC;oCAAE,WAAU;8CAAgB;;;;;;;;;;;;sCAKjC,8OAAC;4BAAI,WAAU;;8CACX,8OAAC;oCAAG,WAAU;8CAA6B;;;;;;gCAG1C,SAAS,GAAG,CAAC,CAAC,SAAS,sBACpB,8OAAC;wCAEG,WAAU;;0DAEV,8OAAC,QAAQ,IAAI;gDAAC,WAAU;;;;;;0DACxB,8OAAC;;kEACG,8OAAC;wDAAG,WAAU;kEACT,QAAQ,KAAK;;;;;;kEAElB,8OAAC;wDAAE,WAAU;kEACR,QAAQ,WAAW;;;;;;;;;;;;;uCATvB;;;;;;;;;;;;;;;;;8BAkBrB,8OAAC;oBAAI,WAAU;8BACX,cAAA,8OAAC;wBAAI,WAAU;;0CACX,8OAAC;gCAAI,WAAU;;kDACX,8OAAC;wCAAG,WAAU;kDAAwC;;;;;;kDAGtD,8OAAC;wCAAE,WAAU;kDAAgB;;;;;;;;;;;;0CAKjC,8OAAC;gCAAK,UAAU;gCAAc,WAAU;;kDAEpC,8OAAC;;0DACG,8OAAC;gDAAM,WAAU;0DAA+C;;;;;;0DAGhE,8OAAC;gDAAI,WAAU;;kEACX,8OAAC;wDAAI,WAAU;kEACX,cAAA,8OAAC,0MAAI;4DAAC,WAAU;;;;;;;;;;;kEAEpB,8OAAC;wDACG,MAAK;wDACL,MAAK;wDACL,OAAO,SAAS,QAAQ;wDACxB,UAAU;wDACV,QAAQ;wDACR,WAAU;wDACV,aAAY;;;;;;;;;;;;;;;;;;kDAMxB,8OAAC;;0DACG,8OAAC;gDAAM,WAAU;0DAA+C;;;;;;0DAGhE,8OAAC;gDAAI,WAAU;;kEACX,8OAAC;wDAAI,WAAU;kEACX,cAAA,8OAAC,0MAAI;4DAAC,WAAU;;;;;;;;;;;kEAEpB,8OAAC;wDACG,MACI,eAAe,SAAS;wDAE5B,MAAK;wDACL,OAAO,SAAS,QAAQ;wDACxB,UAAU;wDACV,QAAQ;wDACR,WAAU;wDACV,aAAY;;;;;;kEAEhB,8OAAC;wDACG,MAAK;wDACL,SAAS,IACL,gBAAgB,CAAC;wDAErB,WAAU;kEAET,6BACG,8OAAC,oNAAM;4DAAC,WAAU;;;;;iFAElB,8OAAC,uMAAG;4DAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;kDAO/B,8OAAC;wCAAI,WAAU;;0DACX,8OAAC;gDACG,MAAK;gDACL,IAAG;gDACH,SAAS;gDACT,UAAU,CAAC,IACP,cAAc,EAAE,MAAM,CAAC,OAAO;gDAElC,WAAU;;;;;;0DAEd,8OAAC;gDACG,SAAQ;gDACR,WAAU;0DACb;;;;;;;;;;;;kDAML,8OAAC;wCACG,MAAK;wCACL,UAAU;wCACV,WAAU;kDAET,wBACG,8OAAC;4CAAI,WAAU;;8DACX,8OAAC;oDAAI,WAAU;;;;;;gDAAuE;;;;;;mDAI1F;;;;;;;;;;;;0CAMZ,8OAAC;gCAAI,WAAU;0CACX,cAAA,8OAAC;oCAAE,WAAU;8CAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASjE;AAEA,MAAM,YAAY;IACd,qBACI,8OAAC,iNAAQ;QAAC,wBAAU,8OAAC;sBAAI;;;;;;kBACrB,cAAA,8OAAC;;;;;;;;;;AAGb;uCAEe"}}]
}