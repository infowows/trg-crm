{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/WOWS_Test/trg-crm/models/ServiceGroup.ts"],"sourcesContent":["import mongoose, { Schema, Document } from \"mongoose\";\n\nexport interface IServiceGroup extends Document {\n    name: string;\n    code: string;\n    description?: string;\n    isActive: boolean;\n    createdAt?: Date;\n    updatedAt?: Date;\n}\n\nconst ServiceGroupSchema: Schema = new Schema(\n    {\n        name: {\n            type: String,\n            required: true,\n            trim: true,\n        },\n        code: {\n            type: String,\n            required: true,\n            unique: true,\n            uppercase: true,\n            trim: true,\n        },\n        description: {\n            type: String,\n            trim: true,\n        },\n        isActive: {\n            type: Boolean,\n            default: true,\n        },\n    },\n    {\n        timestamps: true,\n        collection: \"Nh√≥m D·ªãch V·ª•\",\n    },\n);\n\nexport default mongoose.models.ServiceGroup ||\n    mongoose.model<IServiceGroup>(\"ServiceGroup\", ServiceGroupSchema);\n"],"names":[],"mappings":";;;;AAAA;;AAWA,MAAM,qBAA6B,IAAI,kKAAM,CACzC;IACI,MAAM;QACF,MAAM;QACN,UAAU;QACV,MAAM;IACV;IACA,MAAM;QACF,MAAM;QACN,UAAU;QACV,QAAQ;QACR,WAAW;QACX,MAAM;IACV;IACA,aAAa;QACT,MAAM;QACN,MAAM;IACV;IACA,UAAU;QACN,MAAM;QACN,SAAS;IACb;AACJ,GACA;IACI,YAAY;IACZ,YAAY;AAChB;uCAGW,mKAAQ,CAAC,MAAM,CAAC,YAAY,IACvC,mKAAQ,CAAC,KAAK,CAAgB,gBAAgB"}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///D:/WOWS_Test/trg-crm/lib/dbConnect.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\ninterface Connection {\r\n    isConnected: boolean;\r\n}\r\n\r\nconst connection: Connection = { isConnected: false };\r\n\r\nasync function dbConnect(): Promise<typeof mongoose> {\r\n    if (connection.isConnected) {\r\n        console.log(\"‚ôªÔ∏è Using existing MongoDB connection\");\r\n        return mongoose;\r\n    }\r\n\r\n    try {\r\n        console.log(\"üì° Connecting to MongoDB...\");\r\n\r\n        const db = await mongoose.connect(process.env.MONGODB_URI!, {\r\n            bufferCommands: false,\r\n        });\r\n\r\n        connection.isConnected = db.connections[0].readyState === 1;\r\n\r\n        console.log(\"‚úÖ MongoDB connected successfully\");\r\n        console.log(\"üìä Database name:\", db.connection.name);\r\n\r\n        return db;\r\n    } catch (error) {\r\n        console.error(\"‚ùå MongoDB connection error:\", error);\r\n        connection.isConnected = false;\r\n        throw error;\r\n    }\r\n}\r\n\r\nexport default dbConnect;\r\n"],"names":[],"mappings":";;;;AAAA;;AAMA,MAAM,aAAyB;IAAE,aAAa;AAAM;AAEpD,eAAe;IACX,IAAI,WAAW,WAAW,EAAE;QACxB,QAAQ,GAAG,CAAC;QACZ,OAAO,mKAAQ;IACnB;IAEA,IAAI;QACA,QAAQ,GAAG,CAAC;QAEZ,MAAM,KAAK,MAAM,mKAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAG;YACxD,gBAAgB;QACpB;QAEA,WAAW,WAAW,GAAG,GAAG,WAAW,CAAC,EAAE,CAAC,UAAU,KAAK;QAE1D,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,qBAAqB,GAAG,UAAU,CAAC,IAAI;QAEnD,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,WAAW,WAAW,GAAG;QACzB,MAAM;IACV;AACJ;uCAEe"}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///D:/WOWS_Test/trg-crm/app/api/service-groups/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport ServiceGroup from \"@/models/ServiceGroup\";\nimport dbConnect from \"@/lib/dbConnect\";\n\n// GET - L·∫•y danh s√°ch nh√≥m d·ªãch v·ª•\nexport async function GET(request: NextRequest) {\n    try {\n        await dbConnect();\n\n        const { searchParams } = new URL(request.url);\n        const page = parseInt(searchParams.get(\"page\") || \"1\");\n        const limit = parseInt(searchParams.get(\"limit\") || \"10\");\n        const search = searchParams.get(\"search\") || \"\";\n        const status = searchParams.get(\"status\") || \"all\";\n\n        const query: any = {};\n\n        // T√¨m ki·∫øm theo t√™n ho·∫∑c m√£\n        if (search) {\n            query.$or = [\n                { name: { $regex: search, $options: \"i\" } },\n                { code: { $regex: search, $options: \"i\" } },\n            ];\n        }\n\n        // L·ªçc theo tr·∫°ng th√°i\n        if (status !== \"all\") {\n            query.isActive = status === \"active\";\n        }\n\n        const skip = (page - 1) * limit;\n\n        const [serviceGroups, total] = await Promise.all([\n            ServiceGroup.find(query)\n                .sort({ createdAt: -1 })\n                .skip(skip)\n                .limit(limit),\n            ServiceGroup.countDocuments(query),\n        ]);\n\n        return NextResponse.json({\n            success: true,\n            data: serviceGroups,\n            pagination: {\n                page,\n                limit,\n                total,\n                totalPages: Math.ceil(total / limit),\n            },\n        });\n    } catch (error: any) {\n        console.error(\"Error fetching service groups:\", error);\n        return NextResponse.json(\n            { success: false, message: \"Kh√¥ng th·ªÉ t·∫£i danh s√°ch nh√≥m d·ªãch v·ª•\" },\n            { status: 500 },\n        );\n    }\n}\n\n// POST - T·∫°o nh√≥m d·ªãch v·ª• m·ªõi\nexport async function POST(request: NextRequest) {\n    try {\n        await dbConnect();\n\n        const body = await request.json();\n        const { name, code, description, isActive } = body;\n\n        // Validation\n        if (!name || !name.trim()) {\n            return NextResponse.json(\n                { success: false, message: \"T√™n nh√≥m d·ªãch v·ª• l√† b·∫Øt bu·ªôc\" },\n                { status: 400 },\n            );\n        }\n\n        if (!code || !code.trim()) {\n            return NextResponse.json(\n                { success: false, message: \"M√£ nh√≥m d·ªãch v·ª• l√† b·∫Øt bu·ªôc\" },\n                { status: 400 },\n            );\n        }\n\n        // Ki·ªÉm tra m√£ ƒë√£ t·ªìn t·∫°i ch∆∞a\n        const existingGroup = await ServiceGroup.findOne({\n            code: code.toUpperCase().trim(),\n        });\n\n        if (existingGroup) {\n            return NextResponse.json(\n                { success: false, message: \"M√£ nh√≥m d·ªãch v·ª• ƒë√£ t·ªìn t·∫°i\" },\n                { status: 400 },\n            );\n        }\n\n        // T·∫°o nh√≥m d·ªãch v·ª• m·ªõi\n        const serviceGroup = new ServiceGroup({\n            name: name.trim(),\n            code: code.toUpperCase().trim(),\n            description: description?.trim() || \"\",\n            isActive: isActive !== undefined ? isActive : true,\n        });\n\n        await serviceGroup.save();\n\n        return NextResponse.json({\n            success: true,\n            message: \"T·∫°o nh√≥m d·ªãch v·ª• th√†nh c√¥ng\",\n            data: serviceGroup,\n        });\n    } catch (error: any) {\n        console.error(\"Error creating service group:\", error);\n\n        if (error.code === 11000) {\n            return NextResponse.json(\n                { success: false, message: \"M√£ nh√≥m d·ªãch v·ª• ƒë√£ t·ªìn t·∫°i\" },\n                { status: 400 },\n            );\n        }\n\n        return NextResponse.json(\n            { success: false, message: \"Kh√¥ng th·ªÉ t·∫°o nh√≥m d·ªãch v·ª• m·ªõi\" },\n            { status: 500 },\n        );\n    }\n}\n"],"names":[],"mappings":"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"}}]
}