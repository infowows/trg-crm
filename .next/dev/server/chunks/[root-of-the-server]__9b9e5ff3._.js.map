{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/WOWS_DEV/TruongGiang_CRM/TruongGiang_CRM_NextJS/trg-crm-webapp/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const body = await request.json();\r\n        const { username, password } = body;\r\n\r\n        // Mock authentication - trong thực tế sẽ kết nối với backend\r\n        if (username === \"admin\" && password === \"admin123\") {\r\n            const user = {\r\n                id: \"1\",\r\n                username: \"admin\",\r\n                email: \"admin@trgcrm.com\",\r\n                ho_ten: \"Nguyễn Văn Admin\",\r\n                phong_ban: \"Ban Giám đốc\",\r\n                chuc_vu: \"Giám đốc\",\r\n                phan_quyen: \"Admin\",\r\n            };\r\n\r\n            const token = \"mock-jwt-token-\" + Date.now();\r\n\r\n            const response = NextResponse.json({\r\n                success: true,\r\n                message: \"Đăng nhập thành công\",\r\n                user,\r\n                token,\r\n            });\r\n\r\n            // Set HTTP-only cookie\r\n            response.cookies.set(\"token\", token, {\r\n                httpOnly: true,\r\n                secure: process.env.NODE_ENV === \"production\",\r\n                sameSite: \"lax\",\r\n                maxAge: 60 * 60 * 24 * 7, // 7 days\r\n                path: \"/\",\r\n            });\r\n\r\n            return response;\r\n        }\r\n\r\n        return NextResponse.json(\r\n            {\r\n                success: false,\r\n                message: \"Tên đăng nhập hoặc mật khẩu không đúng\",\r\n            },\r\n            { status: 401 },\r\n        );\r\n    } catch (error) {\r\n        console.error(\"Login error:\", error);\r\n        return NextResponse.json(\r\n            { success: false, message: \"Có lỗi xảy ra. Vui lòng thử lại.\" },\r\n            { status: 500 },\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAoB;IAC3C,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG;QAE/B,6DAA6D;QAC7D,IAAI,aAAa,WAAW,aAAa,YAAY;YACjD,MAAM,OAAO;gBACT,IAAI;gBACJ,UAAU;gBACV,OAAO;gBACP,QAAQ;gBACR,WAAW;gBACX,SAAS;gBACT,YAAY;YAChB;YAEA,MAAM,QAAQ,oBAAoB,KAAK,GAAG;YAE1C,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;gBAC/B,SAAS;gBACT,SAAS;gBACT;gBACA;YACJ;YAEA,uBAAuB;YACvB,SAAS,OAAO,CAAC,GAAG,CAAC,SAAS,OAAO;gBACjC,UAAU;gBACV,QAAQ,oDAAyB;gBACjC,UAAU;gBACV,QAAQ,KAAK,KAAK,KAAK;gBACvB,MAAM;YACV;YAEA,OAAO;QACX;QAEA,OAAO,gJAAY,CAAC,IAAI,CACpB;YACI,SAAS;YACT,SAAS;QACb,GACA;YAAE,QAAQ;QAAI;IAEtB,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS;YAAO,SAAS;QAAmC,GAC9D;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}